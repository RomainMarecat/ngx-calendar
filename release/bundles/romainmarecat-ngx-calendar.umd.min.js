!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core"),require("@angular/flex-layout"),require("@angular/material"),require("moment"),require("twix")):"function"==typeof define&&define.amd?define("@romainmarecat/ngx-calendar",["exports","@angular/common","@angular/core","@angular/flex-layout","@angular/material","moment","twix"],e):e(((t=t||self).romainmarecat=t.romainmarecat||{},t.romainmarecat["ngx-calendar"]={}),t.ng.common,t.ng.core,t.ng["flex-layout"],t.ng.material,t.moment)}(this,(function(t,e,n,s,i,o){"use strict";var a={absence:0,session:1};a[a.absence]="absence",a[a.session]="session";var r=o,l=function(){function t(){this.sessionAdded=new n.EventEmitter,this.sessionRemoved=new n.EventEmitter,this.startChanged=new n.EventEmitter,this.endChanged=new n.EventEmitter,this.slotLocked=new n.EventEmitter}return t.prototype.onNextDay=function(){var t=1;"week"===this.viewMode&&(t=7),this.start=r(this.start).add(t,"day"),this.startChanged.emit(this.start)},t.prototype.isAllSlotNotAvailable=function(){var t=this;if(this.days&&this.days.length>0)return 0===this.days.filter((function(e){return t.daysAvailability.get(e.key).length>0})).length},t.prototype.getAvailabilities=function(t){return this.daysAvailability.get(t)},t.prototype.getSessionTitle=function(t,e){var n=t.value.format("YYYY-MM-DD")+e;if(this.sessions&&this.sessions.has(n)){var s=this.sessions.get(n);return r(s.start).format("HH:mm")+" - "+r(s.end).format("HH:mm")}return""},t.prototype.getSessionTooltip=function(t,e){var n=t.value.format("YYYY-MM-DD")+e;if(this.sessions&&this.sessions.has(n)){var s=this.sessions.get(n);if(s.comment)return s.comment}return""},t.prototype.onTimeSlotClicked=function(t,e){var n=t.value.format("YYYY-MM-DD")+e;if(this.isSlotBusy(t,e)||this.isSlotEarly(t,e))this.slotLocked.emit(!0);else if(this.isDateTimeInSessionsFromCurrentUser(t,e)||this.isSlotInSession(t,e)){if(this.sessions.has(n)){var s={key:n,session:this.sessions.get(n)};this.removeSession(s)}}else{var i=r(n,"YYYY-MM-DDHH:mm"),o=i.clone().add(this.onlineSession.duration,"minutes");this.addSession(i,o)}},t.prototype.addSession=function(t,e){Date.prototype.toJSON=function(){return r(this).format()};var n={id:null,start:t.toDate(),end:e.toDate(),pause:this.onlineSession.pause||0,duration:this.onlineSession.duration,nb_persons:1,event_type:a.session,comment:this.bodyConfiguration.calendar.session.info,user:this.user};this.sessionAdded.emit(n)},t.prototype.removeSession=function(t){this.sessionRemoved.emit(t)},t.prototype.isDayBusy=function(t,e){var n=t.value.format("YYYY-MM-DD")+e;return this.daysBusySlotNumber&&this.daysAvailabilitySlotNumber&&this.daysBusySlotNumber.has(n)&&this.daysAvailabilitySlotNumber.has(n)&&this.daysBusySlotNumber.get(n)>=this.daysAvailabilitySlotNumber.get(n)},t.prototype.isSlotBusy=function(t,e){var n=t.value.format("YYYY-MM-DD")+e;return this.busySlots&&this.busySlots.has(n)},t.prototype.isSlotEarly=function(t,e){var n=t.value.format("YYYY-MM-DD")+e;return this.earlySlots&&this.earlySlots.has(n)||this.pauseSlots&&this.pauseSlots.has(n)},t.prototype.isSlotInSession=function(t,e){var n=t.value.format("YYYY-MM-DD")+e;return this.sessionsSlots&&this.sessionsSlots.has(n)},t.prototype.isDateTimeInSessionsFromCurrentUser=function(t,e){var n=t.value.format("YYYY-MM-DD")+e;return this.sessions&&this.sessions.has(n)},t.prototype.isSlotSessionEnd=function(t,e){var n=t.value.format("YYYY-MM-DD")+e;return this.sessionsEndSlots&&this.sessionsEndSlots.has(n)},t.decorators=[{type:n.Component,args:[{selector:"lib-calendar-body",template:'<div class="calendar-body-wrapper">\n  <table class="calendar-body-table-wrapper table table-bordered">\n    <thead class="calendar-body-table-head">\n    <tr class="calendar-body-head-day-row"\n        *ngIf="viewMode !== \'day\'">\n      <th class="calendar-body-day-header text-center"\n          *ngFor="let day of days">\n        <span class="truncate">{{ day.title }}</span>\n      </th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class="calendar-body-row">\n      <td class="calendar-body-column-content text-center"\n          [attr.id]="day.key"\n          *ngFor="let day of days; let keyDay = index">\n        <div class="time-slot"\n             [class.busy]="isSlotBusy(day, time)"\n             [class.early]="isSlotEarly(day, time)"\n             [class.session]="isSlotInSession(day, time)"\n             [class.session-start]="isDateTimeInSessionsFromCurrentUser(day, time)"\n             [class.session-end]="isSlotSessionEnd(day, time)"\n             *ngFor="let time of getAvailabilities(day.key)">\n          <div class="time-content">\n            <button type="button"\n                    class="slot-available"\n                    (click)="onTimeSlotClicked(day, time)"\n                    *ngIf="!isDateTimeInSessionsFromCurrentUser(day, time); else sessionTitle">\n              <span class="default-time">{{ time }}</span>\n            </button>\n            <ng-template #sessionTitle>\n              <button type="button"\n                      class="slot-session">\n                {{ getSessionTitle(day, time)}}\n              </button>\n            </ng-template>\n            <a class="link-close" (click)="onTimeSlotClicked(day, time)">\n              <mat-icon class="icon-close"\n                        *ngIf="isDateTimeInSessionsFromCurrentUser(day, time)">\n                close\n              </mat-icon>\n            </a>\n          </div>\n          <div class="slot-busy"\n               *ngIf="getAvailabilities(day.key).length <= 0 || isDayBusy(day, time)">\n            <span>{{bodyConfiguration.calendar.availability.empty}}</span>\n          </div>\n        </div>\n        <div class="next-slot"\n             *ngIf="isAllSlotNotAvailable() && keyDay === days.length-1">\n          <button type="button"\n                  role="button"\n                  [title]="bodyConfiguration.calendar.availability.slot"\n                  (click)="onNextDay()">\n            <span>{{ bodyConfiguration.calendar.availability.slot }}</span>\n            <mat-icon>keyboard_arrow_right</mat-icon>\n          </button>\n        </div>\n      </td>\n    </tr>\n    </tbody>\n  </table>\n</div>\n',styles:[".calendar-body-wrapper .calendar-body-column-content{max-width:240px}.calendar-body-wrapper .calendar-body-column-content .time-slot{padding:5px}.calendar-body-wrapper .calendar-body-column-content .time-slot button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);font-family:Lato,Roboto,sans-serif;font-size:14px;font-weight:500}.calendar-body-wrapper .calendar-body-column-content .time-slot button.slot-available{cursor:pointer;width:120px}.calendar-body-wrapper .calendar-body-column-content .time-slot:hover button.slot-available{background-color:#006400;color:#fff}.calendar-body-wrapper .calendar-body-column-content .time-slot.busy{display:none}.calendar-body-wrapper .calendar-body-column-content .time-slot.busy button.slot-available{color:#8b0000;cursor:not-allowed}.calendar-body-wrapper .calendar-body-column-content .time-slot.early button.slot-available{cursor:not-allowed;color:orange}.calendar-body-wrapper .calendar-body-column-content .time-slot.session .time-content{position:relative;padding:5px 5px 5px 0}.calendar-body-wrapper .calendar-body-column-content .time-slot.session .time-content .slot-session{width:120px;background-color:#ff8c00}.calendar-body-wrapper .calendar-body-column-content .time-slot.session .time-content .link-close .icon-close{position:absolute;right:5px;top:6px;font-size:14px}.calendar-body-wrapper .calendar-body-column-content .time-slot.session .time-content .link-close,.calendar-body-wrapper .calendar-body-column-content .time-slot.session .time-content .link-close:hover{cursor:pointer}.calendar-body-wrapper .calendar-body-column-content .time-slot.session-start{border-top-left-radius:3px;border-top-right-radius:3px}.calendar-body-wrapper .calendar-body-column-content .time-slot.session-start .slot-session{color:#000;cursor:text}.calendar-body-wrapper .calendar-body-column-content .time-slot.session-end{border-bottom-left-radius:3px;border-bottom-right-radius:3px}"]}]}],t.propDecorators={user:[{type:n.Input}],onlineSession:[{type:n.Input}],viewMode:[{type:n.Input}],start:[{type:n.Input}],end:[{type:n.Input}],days:[{type:n.Input}],daysAvailability:[{type:n.Input}],daysBusySlotNumber:[{type:n.Input}],daysAvailabilitySlotNumber:[{type:n.Input}],busySlots:[{type:n.Input}],earlySlots:[{type:n.Input}],pauseSlots:[{type:n.Input}],sessionsSlots:[{type:n.Input}],sessionsEndSlots:[{type:n.Input}],sessions:[{type:n.Input}],bodyConfiguration:[{type:n.Input}],sessionAdded:[{type:n.Output}],sessionRemoved:[{type:n.Output}],startChanged:[{type:n.Output}],endChanged:[{type:n.Output}],slotLocked:[{type:n.Output}]},t}();var d=o,u=function(){function t(){this.switchedView=new n.EventEmitter,this.startChanged=new n.EventEmitter}return Object.defineProperty(t.prototype,"viewMode",{get:function(){return this._viewMode},set:function(t){this.switchView(t)},enumerable:!0,configurable:!0}),t.prototype.switchView=function(t){this._viewMode=t,this.onSwitchedView(t)},t.prototype.onSwitchedView=function(t){this.switchedView.emit(t)},t.prototype.onStartChanged=function(t){this.startChanged.emit(t)},t.prototype.goToToday=function(){this.start=d(),this.onStartChanged(this.start)},t.prototype.isToday=function(){return d()===d(this.start)},t.prototype.previousDay=function(){var t=1;"week"===this.viewMode&&(t=7),this.start=d(this.start).subtract(t,"day"),this.onStartChanged(this.start)},t.prototype.nextDay=function(){var t=1;"week"===this.viewMode&&(t=7),this.start=d(this.start).add(t,"day"),this.onStartChanged(this.start)},t.decorators=[{type:n.Component,args:[{selector:"lib-calendar-header",template:'<div fxLayout="row wrap"\n     fxLayoutAlign="start stretch"\n     fxLayout.xs="column"\n     fxLayoutAlign.xs="start center"\n     fxLayoutGap.xs="10px"\n     *ngIf="headerConfiguration">\n\n  <div class="left-actions"\n       fxLayout="row"\n       fxLayoutAlign="start stretch"\n       fxLayoutGap="10px"\n       fxLayout.xs="row"\n       fxLayoutAlign.xs="center stretch"\n       fxLayoutGap.xs="10px">\n    <button class="button-actions"\n            (click)="previousDay()"\n            type="button"\n            role="button"\n            [title]="headerConfiguration.calendar.cta.previous">\n      <mat-icon>keyboard_arrow_left</mat-icon>\n    </button>\n    <button class="button-actions"\n            (click)="nextDay()"\n            type="button"\n            role="button"\n            [title]="headerConfiguration.calendar.cta.next">\n      <mat-icon>keyboard_arrow_right</mat-icon>\n    </button>\n    <button class="button-actions"\n            [title]="headerConfiguration.calendar.back_today"\n            [disabled]="isToday()"\n            (click)="goToToday()"\n            role="button">\n      <mat-icon>today</mat-icon>\n    </button>\n  </div>\n  <div class="right-actions"\n       fxLayout="row wrap"\n       fxLayoutAlign="end stretch"\n       fxLayoutGap="10px"\n       fxLayout.xs="row wrap"\n       fxLayoutAlign.xs="center stretch"\n       fxLayoutGap.xs="10px">\n    <button class="button-actions"\n            type="button"\n            role="button"\n            [title]="headerConfiguration.calendar.today"\n            [disabled]="true"\n            [class.hide-on-small-only]="end?.format(\'YYYY-MM-DD\') !== start?.format(\'YYYY-MM-DD\')">\n      <span>{{ start?.format(\'LL\') }}</span>\n      <span *ngIf="end?.format(\'YYYY-MM-DD\') !== start?.format(\'YYYY-MM-DD\')">\n        - {{ end?.format(\'LL\') }}\n      </span>\n    </button>\n    <button class="button-actions"\n            type="button"\n            role="button"\n            [title]="headerConfiguration.calendar.week"\n            [class.active]="viewMode === \'week\'"\n            (click)="switchView(\'week\')"\n            fxHide.lt-md="true">\n      <mat-icon>view_week</mat-icon>\n      <span fxHide.lt-md="true">{{ headerConfiguration.calendar.week }}</span>\n    </button>\n    <button class="button-actions"\n            type="button"\n            role="button"\n            [title]="headerConfiguration.calendar.three_days"\n            [class.active]="viewMode === \'three_days\'"\n            (click)="switchView(\'three_days\')"\n            fxHide.lt-md="true">\n      <mat-icon>view_column</mat-icon>\n      <span fxHide.lt-md="true">{{ headerConfiguration.calendar.three_days }}</span>\n    </button>\n    <button class="button-actions"\n            type="button"\n            role="button"\n            [title]="headerConfiguration.calendar.day"\n            [class.active]="viewMode === \'day\'"\n            (click)="switchView(\'day\')"\n            fxHide.lt-md="true">\n      <mat-icon>view_day</mat-icon>\n      <span fxHide.lt-md="true">{{ headerConfiguration.calendar.day }}</span>\n    </button>\n  </div>\n</div>\n',styles:[".button-actions span{margin-left:5px}button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:36px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);font-family:Lato,Roboto,sans-serif;font-size:14px;font-weight:500;display:inline-flex;align-items:center;justify-content:center}"]}]}],t.propDecorators={start:[{type:n.Input}],end:[{type:n.Input}],switchedView:[{type:n.Output}],startChanged:[{type:n.Output}],headerConfiguration:[{type:n.Input}],viewMode:[{type:n.Input}]},t}();var c=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var s,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(s=o.next()).done;)a.push(s.value)}catch(t){i={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},y=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t},m=o,h=function(){function t(t){this.cd=t,this.onlineSession={id:null,comment:"",name:"",max_persons:1,booking_delay:1,duration:15,pause:0,price:10,start_date:"2019-01-01",end_date:"2030-12-31",start_time:"08:00",end_time:"19:00"},this.start=m(),this.end=m(),this.calendarConfiguration={calendar:{cta:{next:"suivant",previous:"précédent"},today:"aujourd'hui",back_today:"revenir à la date d'aujourd'hui",day:"jour",three_days:"3 jours",week:"semaine",title:"réserver votre créneau",subtitle:"toutes les disponibilités",availability:{empty:"Aucune disponibilité",slot:"Prochaine disponibilité"},session:{info:"Créneau vérrouillé"}}},this.viewModeChanged=new n.EventEmitter,this.sessionCreated=new n.EventEmitter,this.sessionRemoved=new n.EventEmitter,this.days=[],this._sessionsEntries=[],this._viewMode="week"}return Object.defineProperty(t.prototype,"sessionsEntries",{get:function(){return this._sessionsEntries},set:function(t){t.length&&(this._sessionsEntries=t),this.loadCalendar()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewMode",{get:function(){return this._viewMode},set:function(t){this._viewMode=t,this.setViewMode()},enumerable:!0,configurable:!0}),t.splitRangeToNextTime=function(e,n){var s=e.next();return{time:s,mmtTime:t.getMinutesDifference(m(s.toDate()),n)}},t.getMinutesDifference=function(t,e){return t.minutes()%e!=0&&t.minutes(t.minutes()-t.minutes()%e),t},t.geStartEndFromStartAndSessionDuration=function(t,e,n){t.twix(e).iterate(n,"minutes");return{start:t,end:e}},t.prototype.ngOnChanges=function(){this.loadCalendar()},t.prototype.setCalendar=function(){this.sessionsSlots=new Set,this.sessionsEndSlots=new Set,this.earlySlots=new Set,this.pauseSlots=new Set,this.sessions=new Map},t.prototype.setViewMode=function(){if("day"===this.viewMode)return this.end=this.start,this.calendarStart=m(this.start).startOf("day"),void(this.calendarEnd=m(this.end).endOf("day"));if("three_days"===this.viewMode)return this.end=m(this.start).add(2,"days"),this.calendarStart=m(this.start).startOf("day"),void(this.calendarEnd=m(this.end).endOf("day"));this.start||(this.start=m()),this.start=m(this.start).day(0),this.end=m(this.start).add(6,"days"),this.calendarStart=m(this.start).startOf("day"),this.calendarEnd=m(this.end).endOf("day")},t.prototype.loadCalendar=function(){this.setCalendar(),this.setViewMode(),this.loadEvents(this.start,this.end),this.setDateRange(this.start,this.end),this.loadAvailabilities()},t.prototype.setDateRange=function(t,e){this.daysAvailability=new Map;var n=t.twix(e).iterate(1,"days");for(this.days=[];n.hasNext();){var s=n.next();this.days.push({title:s.format("DD/MM/YYYY"),key:s.format("YYYY-MM-DD"),value:m(s.toDate())}),this.daysAvailability.set(s.format("YYYY-MM-DD"),[])}},t.prototype.onSwithedView=function(t){this.viewMode=t,this.viewModeChanged.emit(t),this.loadCalendar()},t.prototype.onStartChanged=function(t){this.start=t,this.loadCalendar()},t.prototype.onSessionAdded=function(t){this.sessions.set(m(t.start).format("YYYY-MM-DDHH:mm"),t),this.addSession(t),this.sessionCreated.emit(t)},t.prototype.onSessionRemoved=function(t){this.sessions.delete(t.key),this.removeSession(t.session),this.sessionRemoved.emit(t.session)},t.prototype.loadAvailabilities=function(){var t=this;if(this.daysAvailability&&this.onlineSession){console.log("online",this.onlineSession),this.realDuration=this.onlineSession.duration;var e=m(this.onlineSession.start_date,"YYYY-MM-DD").startOf("day"),n=m(this.onlineSession.end_date,"YYYY-MM-DD").endOf("day");this.daysAvailabilitySlotNumber=new Map,this.daysAvailability.forEach((function(s,i){var o=0,a=m(i,"YYYY-MM-DD").hour(8),r=m(i+t.onlineSession.start_time,"YYYY-MMDDHH:mm");if(!r.isBefore(m().startOf("day"))){var l=m().add(t.onlineSession.booking_delay,"hours"),d=m(i+t.onlineSession.end_time,"YYYY-MM-DDHH:mm");d.subtract(t.realDuration,"minutes");var u=r.twix(d).iterate(t.onlineSession.duration,"minutes");if(t.calendarStart&&t.calendarEnd&&a.isBetween(e,n))for(;u.hasNext();){var c=u.next();m(c.toDate()).isBefore(l)||(s.push(c.format("HH:mm")),o++)}t.daysAvailabilitySlotNumber.set(i,o)}}))}},t.prototype.addSession=function(e){for(var n=m(e.start),s=m(e.end),i=n.twix(s).iterateInner(e.duration,"minutes");i.hasNext();){var o=i.next();this.sessionsSlots.add(o.format("YYYY-MM-DDHH:mm")),i.hasNext()||this.sessionsEndSlots.add(o.format("YYYY-MM-DDHH:mm"))}var a=n.clone().subtract(this.realDuration,"minutes");a.minutes(a.minutes()-a.minutes()%e.duration+e.duration);for(var r=a.twix(n).iterate(e.duration,"minutes");r.hasNext();){o=r.next();(c=t.getMinutesDifference(m(o.toDate()),e.duration)).isSameOrAfter(a)&&c.isBefore(n)&&this.earlySlots.add(c.format("YYYY-MM-DDHH:mm"))}var l=s.clone();l.subtract(l.minutes()%e.duration);for(var d=l.clone().add(e.pause,"minutes"),u=l.twix(d).iterate(e.duration,"minutes");u.hasNext();){var c;o=u.next();(c=t.getMinutesDifference(m(o.toDate()),e.duration)).isSameOrAfter(l)&&c.isBefore(d)&&this.pauseSlots.add(c.format("YYYY-MM-DDHH:mm"))}},t.prototype.removeSession=function(e){for(var n=m(e.start),s=m(e.end),i=n.twix(s).iterate(e.duration,"minutes");i.hasNext();){var o=i.next();this.sessionsSlots.delete(o.format("YYYY-MM-DDHH:mm")),i.hasNext()||this.sessionsEndSlots.delete(o.format("YYYY-MM-DDHH:mm"))}var a=n.clone().subtract(this.realDuration,"minutes");a.minutes(a.minutes()-a.minutes()%e.duration+e.duration);for(var r=a.twix(n).iterate(e.duration,"minutes");r.hasNext();){o=r.next();(c=t.getMinutesDifference(m(o.toDate()),e.duration)).isSameOrAfter(a)&&c.isBefore(n)&&this.earlySlots.delete(c.format("YYYY-MM-DDHH:mm"))}if(e.pause){var l=s.clone();l.subtract(l.minutes()%e.duration);for(var d=l.clone().add(e.pause,"minutes"),u=l.twix(d).iterate(e.duration,"minutes");u.hasNext();){var c;o=u.next();(c=t.getMinutesDifference(m(o.toDate()),e.duration)).isSameOrAfter(l)&&c.isBefore(d)&&this.pauseSlots.delete(c.format("YYYY-MM-DDHH:mm"))}}},t.prototype.loadEvents=function(t,e){var n=this;this.onlineSession&&(this.busySlots=new Set,this.daysBusySlotNumber=new Map,console.log("start/end",t,e),Array.isArray(this._sessionsEntries)&&this._sessionsEntries.length&&(this._sessionsEntries=y(this._sessionsEntries.filter((function(s){if(m(s.start).isSameOrAfter(t)&&m(s.end).isSameOrBefore(e)){var i=m(s.start,"YYYY-MM-DDHH:mm");return console.log("busy slot",i),i=n.buildinBusySlot(i,s),console.log("busy slot",i),n.buildingEarliestSlot(i),!0}return!1})))),this.cd.markForCheck())},t.prototype.buildinBusySlot=function(e,n){var s=m(n.end,"YYYY-MM-DDHH:mm");if(!(e&&e.isValid()&&s&&s.isValid()&&e.isBefore(s)))return console.error("invalid dates"),null;for(var i=e.twix(s).iterate(n.duration,"minutes");i.hasNext();){var o=t.splitRangeToNextTime(i,n.duration),a=o.time;o.mmtTime;if(this.daysAvailability&&this.daysAvailability.has(a.format("YYYY-MM-DD"))&&!this.busySlots.has(a.format("YYYY-MM-DDHH:mm"))&&this.daysAvailability.get(a.format("YYYY-MM-DD")).indexOf(a.format("HH:mm"))>=0){if(!n.user||n.user&&this.user&&n.user.id!==this.user.id){var r=this.daysBusySlotNumber.has(a.format("YYYY-MM-DD"))?this.daysBusySlotNumber.get(a.format("YYYY-MM-DD")):0;r++,this.daysBusySlotNumber.set(a.format("YYYY-MM-DD"),r),this.busySlots.add(a.format("YYYY-MM-DDHH:mm"))}n.user&&this.user&&n.user.id===this.user.id&&(this.sessionsSlots.add(a.format("YYYY-MM-DDHH:mm")),this.sessions.set(a.format("YYYY-MM-DDHH:mm"),n),i.hasNext()||this.sessionsEndSlots.add(a.format("YYYY-MM-DDHH:mm")))}}return e},t.prototype.buildingEarliestSlot=function(e){if(e&&this.realDuration){var n=e.clone().subtract(this.realDuration,"minutes");n.minutes(n.minutes()-n.minutes()%this.onlineSession.duration+this.onlineSession.duration);for(var s=n.twix(e).iterate(this.onlineSession.duration,"minutes");s.hasNext();){var i=t.splitRangeToNextTime(s,this.onlineSession.duration),o=i.time;i.mmtTime;if(this.daysAvailability&&this.daysAvailability.has(o.format("YYYY-MM-DD"))&&!this.busySlots.has(o.format("YYYY-MM-DDHH:mm"))&&this.daysAvailability.get(o.format("YYYY-MM-DD")).indexOf(o.format("HH:mm"))>=0){var a=this.daysBusySlotNumber.has(o.format("YYYY-MM-DD"))?this.daysBusySlotNumber.get(o.format("YYYY-MM-DD")):0;a++,this.daysBusySlotNumber.set(o.format("YYYY-MM-DD"),a)}this.busySlots.add(o.format("YYYY-MM-DDHH:mm"))}}},t.decorators=[{type:n.Component,args:[{selector:"ngx-calendar",template:'<div class="week-calendar-wrapper">\n  <div class="week-calendar-header">\n\n\n    <div class="week-calendar-title">\n\n\n      <lib-calendar-header [start]="start"\n                           [end]="end"\n                           [headerConfiguration]="calendarConfiguration"\n                           [viewMode]="viewMode"\n                           (switchedView)="onSwithedView($event)"\n                           (startChanged)="onStartChanged($event)"></lib-calendar-header>\n\n    </div>\n\n  </div>\n\n  <div>\n\n\n    <lib-calendar-body [bodyConfiguration]="calendarConfiguration"\n                       [onlineSession]="onlineSession"\n                       [days]="days"\n                       [viewMode]="viewMode"\n                       [start]="start"\n                       [end]="end"\n                       [daysAvailability]="daysAvailability"\n                       [daysBusySlotNumber]="daysBusySlotNumber"\n                       [daysAvailabilitySlotNumber]="daysAvailabilitySlotNumber"\n                       [busySlots]="busySlots"\n                       [user]="user"\n                       [earlySlots]="earlySlots"\n                       [pauseSlots]="pauseSlots"\n                       [sessionsSlots]="sessionsSlots"\n                       [sessionsEndSlots]="sessionsEndSlots"\n                       [sessions]="sessions"\n                       (startChanged)="onStartChanged($event)"\n                       (sessionAdded)="onSessionAdded($event)"\n                       (sessionRemoved)="onSessionRemoved($event)"\n                       *ngIf="start && end && days && viewMode"></lib-calendar-body>\n\n  </div>\n</div>\n',styles:[".week-calendar-wrapper .week-calendar-header{padding-bottom:20px}@media (min-width:768px){.week-calendar-wrapper .week-calendar-header .week-calendar-title{width:90vw}}"]}]}],t.ctorParameters=function(){return[{type:n.ChangeDetectorRef}]},t.propDecorators={user:[{type:n.Input}],onlineSession:[{type:n.Input}],start:[{type:n.Input}],end:[{type:n.Input}],calendarConfiguration:[{type:n.Input}],viewModeChanged:[{type:n.Output}],sessionCreated:[{type:n.Output}],sessionRemoved:[{type:n.Output}],sessionsEntries:[{type:n.Input}],viewMode:[{type:n.Input}]},t}();var p=function(){function t(){}return t.decorators=[{type:n.NgModule,args:[{imports:[e.CommonModule,s.FlexLayoutModule,i.MatIconModule],declarations:[h,u,l],exports:[h,u,l]}]}],t}();t.CalendarComponent=h,t.EventType=a,t.NgxCalendarModule=p,t.ɵa=u,t.ɵb=l,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=romainmarecat-ngx-calendar.umd.min.js.map